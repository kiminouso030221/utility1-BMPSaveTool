# 从剪切板自动获取BMP并保存的实用工具

#### 介绍
无聊瞎搞的一个实用工具, 按热键可以把剪切板上BMP图像保存到指定文件夹  
欢迎交流qq1790226429 （大佬带我呜呜）

#### 软件架构
MFC

#### 使用语言
C/C++


#### 实现功能

此工具实现的功能有：

- 获取剪切板数据  
- 热键处理  
- 隐藏主窗口  
- 托盘  
- 防止多个应用程序实例运行  
- 向注册表读取和写入数据保存配置信息  


#### 使用说明

打开程序，程序会到托盘，右击有菜单，里面可以设置保存热键和保存路径，然后按prtscr可以截屏（系统功能），再按预设的热键，就能保存到预设的文件夹啦


#### 

这个工具做了好几天。。大部分功能都是用Windows API实现的，其中最烧心的是从剪切板中创建BMP文件的过程。
我万万没想到PrtScr截屏的BMP文件的文件头中的，压缩属性为3，保存下来的文件根本打不开，最后跟其他BMP文件对比发现压缩属性那一项是0，
在代码中手动设置为0，文件就打开了。
然后，系统PrtScr键截屏跟画图中的复制得到的图像不一样，系统截屏键在内存中存储，在开头BMP信息头后还有12字节的偏移。。如果直接保存得话，打开后图像有错位，放大后看发现刚好错位3像素，由于从左下开始扫描，把保存下来的bmp往左下角放大后发现有三个像素颜色分别是R G B ..刚好对应文件里数据区一开始的那12字节数据。。
无奈只能在保存时手动判断是否有12字节偏移，然后保存时越过那12字节。问题得以解决。
这个工具还是有一些bug，比如部分热键不能用，虽然不提示注册失败，但是就是不能用，。。另外，qq的截图不能保存，可能由于qq用特定的数据格式，或者位图位数问题，懒得弄了。。因为保存bmp这个东西就让我弄了一天，，，累了
